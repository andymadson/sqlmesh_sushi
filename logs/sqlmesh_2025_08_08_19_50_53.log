2025-08-08 19:50:53,847 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'sushi-example.db'} (connection.py:481)
2025-08-08 19:50:54,372 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:483)
2025-08-08 19:50:54,372 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:483)
2025-08-08 19:50:54,454 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: sushi-example.db (connection.py:471)
2025-08-08 19:50:55,983 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:125)
2025-08-08 19:50:55,987 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema "sushi-example".sqlmesh__sushimoderate (evaluator.py:361)
2025-08-08 19:50:55,988 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ SELECT CURRENT_CATALOG() (base.py:2260)
2025-08-08 19:50:55,988 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ SELECT CURRENT_CATALOG() (base.py:2260)
2025-08-08 19:50:55,989 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'sushi-example' AND table_schema = 'sqlmesh__sushimoderate') AND table_name IN ('sushimoderate__customer_revenue_lifetime__2371348360', 'sushimoderate__top_waiters__4200137544', 'sushimoderate__waiter_revenue_by_day__2502736145', 'sushimoderate__customer_lifetime_value__3451320949', 'sushimoderate__items__4183556318', 'sushimoderate__orders__2553744583', 'sushimoderate__order_items__3229655664', 'sushimoderate__customer_segments__3722212309', 'sushimoderate__customer_revenue_by_day__2161423016', 'sushimoderate__customers__1460721243', 'sushimoderate__waiter_names__1494776325') (base.py:2260)
2025-08-08 19:50:56,000 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema "sushi-example".sqlmesh__raw (evaluator.py:361)
2025-08-08 19:50:56,000 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ SELECT CURRENT_CATALOG() (base.py:2260)
2025-08-08 19:50:56,000 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ SELECT CURRENT_CATALOG() (base.py:2260)
2025-08-08 19:50:56,001 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'sushi-example' AND table_schema = 'sqlmesh__raw') AND table_name IN ('raw__marketing__2281409975', 'raw__order_items__654969149', 'raw__demographics__3399964752', 'raw__items__1587933360', 'raw__orders__1960537533') (base.py:2260)
2025-08-08 19:50:56,006 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-08-08 19:50:56,008 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"sushi-example"."sushimoderate"."customer_segments": 2816715227> (evaluator.py:648)
2025-08-08 19:50:56,010 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ 
        SELECT
            customer_id,
            lifetime_value,
            historical_revenue,
            active_months
        FROM sushimoderate.customer_lifetime_value
     (base.py:2260)
2025-08-08 19:50:56,036 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-08 00:00:00, 2025-08-09 00:00:00) into "sushi-example".sqlmesh__sushimoderate.sushimoderate__customer_segments__3722212309' (evaluator.py:703)
2025-08-08 19:50:56,042 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ SELECT CURRENT_CATALOG() (base.py:2260)
2025-08-08 19:50:56,042 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'sushi-example' (base.py:2260)
2025-08-08 19:50:56,043 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE TABLE "sushi-example"."sqlmesh__sushimoderate"."sushimoderate__customer_segments__3722212309" AS SELECT CAST("customer_id" AS INT) AS "customer_id", CAST("lifetime_value" AS DOUBLE) AS "lifetime_value", CAST("historical_revenue" AS DOUBLE) AS "historical_revenue", CAST("active_months" AS BIGINT) AS "active_months", CAST("value_rate" AS DOUBLE) AS "value_rate", CAST("cluster" AS INT) AS "cluster", CAST("segment" AS TEXT) AS "segment", CAST("silhouette" AS DOUBLE) AS "silhouette" FROM (SELECT "customer_id", "lifetime_value", "historical_revenue", "active_months", "value_rate", "cluster", "segment", "silhouette" FROM "sushi-example"."sqlmesh__sushimoderate"."__temp_sushimoderate__customer_segments__3722212309_ry5p9m2v") AS "_subquery" (base.py:2260)
2025-08-08 19:50:56,046 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ DROP TABLE IF EXISTS "sushi-example"."sqlmesh__sushimoderate"."__temp_sushimoderate__customer_segments__3722212309_ry5p9m2v" (base.py:2260)
2025-08-08 19:50:56,048 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-08 00:00:00, 2025-08-09 00:00:00) for snapshot SnapshotId<"sushi-example"."sushimoderate"."customer_segments": 2816715227> (facade.py:619)
2025-08-08 19:50:56,048 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"sushi-example"."sushimoderate"."customer_segments": 2816715227> (interval.py:213)
2025-08-08 19:50:56,063 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-08-08 19:50:56,063 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'dev' (facade.py:167)
2025-08-08 19:50:56,082 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-08-08 19:50:56,086 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema '"sushi-example".sushimoderate__dev' (evaluator.py:1176)
2025-08-08 19:50:56,087 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE SCHEMA IF NOT EXISTS "sushi-example"."sushimoderate__dev" (base.py:2260)
2025-08-08 19:50:56,087 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema '"sushi-example".raw__dev' (evaluator.py:1176)
2025-08-08 19:50:56,087 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE SCHEMA IF NOT EXISTS "sushi-example"."raw__dev" (base.py:2260)
2025-08-08 19:50:56,088 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".raw__dev.demographics' to point at table '"sushi-example".sqlmesh__raw.raw__demographics__3399964752' (evaluator.py:1493)
2025-08-08 19:50:56,088 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."raw__dev"."demographics" AS SELECT * FROM "sushi-example"."sqlmesh__raw"."raw__demographics__3399964752" (base.py:2260)
2025-08-08 19:50:56,092 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".raw__dev.items' to point at table '"sushi-example".sqlmesh__raw.raw__items__1587933360' (evaluator.py:1493)
2025-08-08 19:50:56,093 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."raw__dev"."items" AS SELECT * FROM "sushi-example"."sqlmesh__raw"."raw__items__1587933360" (base.py:2260)
2025-08-08 19:50:56,097 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".raw__dev.marketing' to point at table '"sushi-example".sqlmesh__raw.raw__marketing__2281409975' (evaluator.py:1493)
2025-08-08 19:50:56,097 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."raw__dev"."marketing" AS SELECT * FROM "sushi-example"."sqlmesh__raw"."raw__marketing__2281409975" (base.py:2260)
2025-08-08 19:50:56,101 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".raw__dev.order_items' to point at table '"sushi-example".sqlmesh__raw.raw__order_items__654969149' (evaluator.py:1493)
2025-08-08 19:50:56,101 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."raw__dev"."order_items" AS SELECT * FROM "sushi-example"."sqlmesh__raw"."raw__order_items__654969149" (base.py:2260)
2025-08-08 19:50:56,106 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".raw__dev.orders' to point at table '"sushi-example".sqlmesh__raw.raw__orders__1960537533' (evaluator.py:1493)
2025-08-08 19:50:56,106 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."raw__dev"."orders" AS SELECT * FROM "sushi-example"."sqlmesh__raw"."raw__orders__1960537533" (base.py:2260)
2025-08-08 19:50:56,110 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".sushimoderate__dev.customer_segments' to point at table '"sushi-example".sqlmesh__sushimoderate.sushimoderate__customer_segments__3722212309' (evaluator.py:1493)
2025-08-08 19:50:56,111 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."sushimoderate__dev"."customer_segments" AS SELECT * FROM "sushi-example"."sqlmesh__sushimoderate"."sushimoderate__customer_segments__3722212309" (base.py:2260)
2025-08-08 19:50:56,115 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".sushimoderate__dev.waiter_names' to point at table '"sushi-example".sqlmesh__sushimoderate.sushimoderate__waiter_names__1494776325' (evaluator.py:1493)
2025-08-08 19:50:56,115 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."sushimoderate__dev"."waiter_names" AS SELECT * FROM "sushi-example"."sqlmesh__sushimoderate"."sushimoderate__waiter_names__1494776325" (base.py:2260)
2025-08-08 19:50:56,119 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".sushimoderate__dev.items' to point at table '"sushi-example".sqlmesh__sushimoderate.sushimoderate__items__4183556318' (evaluator.py:1493)
2025-08-08 19:50:56,120 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."sushimoderate__dev"."items" AS SELECT * FROM "sushi-example"."sqlmesh__sushimoderate"."sushimoderate__items__4183556318" (base.py:2260)
2025-08-08 19:50:56,124 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".sushimoderate__dev.order_items' to point at table '"sushi-example".sqlmesh__sushimoderate.sushimoderate__order_items__3229655664' (evaluator.py:1493)
2025-08-08 19:50:56,124 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."sushimoderate__dev"."order_items" AS SELECT * FROM "sushi-example"."sqlmesh__sushimoderate"."sushimoderate__order_items__3229655664" (base.py:2260)
2025-08-08 19:50:56,128 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".sushimoderate__dev.orders' to point at table '"sushi-example".sqlmesh__sushimoderate.sushimoderate__orders__2553744583' (evaluator.py:1493)
2025-08-08 19:50:56,128 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."sushimoderate__dev"."orders" AS SELECT * FROM "sushi-example"."sqlmesh__sushimoderate"."sushimoderate__orders__2553744583" (base.py:2260)
2025-08-08 19:50:56,132 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".sushimoderate__dev.customer_revenue_by_day' to point at table '"sushi-example".sqlmesh__sushimoderate.sushimoderate__customer_revenue_by_day__2161423016' (evaluator.py:1493)
2025-08-08 19:50:56,133 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."sushimoderate__dev"."customer_revenue_by_day" AS SELECT * FROM "sushi-example"."sqlmesh__sushimoderate"."sushimoderate__customer_revenue_by_day__2161423016" (base.py:2260)
2025-08-08 19:50:56,137 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".sushimoderate__dev.customer_revenue_lifetime' to point at table '"sushi-example".sqlmesh__sushimoderate.sushimoderate__customer_revenue_lifetime__2371348360' (evaluator.py:1493)
2025-08-08 19:50:56,137 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."sushimoderate__dev"."customer_revenue_lifetime" AS SELECT * FROM "sushi-example"."sqlmesh__sushimoderate"."sushimoderate__customer_revenue_lifetime__2371348360" (base.py:2260)
2025-08-08 19:50:56,142 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".sushimoderate__dev.customers' to point at table '"sushi-example".sqlmesh__sushimoderate.sushimoderate__customers__1460721243' (evaluator.py:1493)
2025-08-08 19:50:56,142 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."sushimoderate__dev"."customers" AS SELECT * FROM "sushi-example"."sqlmesh__sushimoderate"."sushimoderate__customers__1460721243" (base.py:2260)
2025-08-08 19:50:56,146 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".sushimoderate__dev.waiter_revenue_by_day' to point at table '"sushi-example".sqlmesh__sushimoderate.sushimoderate__waiter_revenue_by_day__2502736145' (evaluator.py:1493)
2025-08-08 19:50:56,146 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."sushimoderate__dev"."waiter_revenue_by_day" AS SELECT * FROM "sushi-example"."sqlmesh__sushimoderate"."sushimoderate__waiter_revenue_by_day__2502736145" (base.py:2260)
2025-08-08 19:50:56,150 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".sushimoderate__dev.customer_lifetime_value' to point at table '"sushi-example".sqlmesh__sushimoderate.sushimoderate__customer_lifetime_value__3451320949' (evaluator.py:1493)
2025-08-08 19:50:56,151 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."sushimoderate__dev"."customer_lifetime_value" AS SELECT * FROM "sushi-example"."sqlmesh__sushimoderate"."sushimoderate__customer_lifetime_value__3451320949" (base.py:2260)
2025-08-08 19:50:56,154 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".sushimoderate__dev.top_waiters' to point at table '"sushi-example".sqlmesh__sushimoderate.sushimoderate__top_waiters__4200137544' (evaluator.py:1493)
2025-08-08 19:50:56,155 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: aca45fb05aaa4026b35634b3600734fd */ CREATE OR REPLACE VIEW "sushi-example"."sushimoderate__dev"."top_waiters" AS SELECT * FROM "sushi-example"."sqlmesh__sushimoderate"."sushimoderate__top_waiters__4200137544" (base.py:2260)
2025-08-08 19:50:56,159 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-08-08 19:50:56,159 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'dev' (environment.py:139)
2025-08-08 19:50:56,187 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
