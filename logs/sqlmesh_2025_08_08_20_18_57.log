2025-08-08 20:18:57,748 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'sushi-example.db'} (connection.py:481)
2025-08-08 20:18:58,266 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:483)
2025-08-08 20:18:58,266 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:483)
2025-08-08 20:18:58,343 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: sushi-example.db (connection.py:471)
2025-08-08 20:19:00,685 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:125)
2025-08-08 20:19:00,688 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema "sushi-example".sqlmesh__sushimoderate (evaluator.py:361)
2025-08-08 20:19:00,689 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 042bab49aaa7487cade5af2a6a1571e7 */ SELECT CURRENT_CATALOG() (base.py:2260)
2025-08-08 20:19:00,689 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 042bab49aaa7487cade5af2a6a1571e7 */ SELECT CURRENT_CATALOG() (base.py:2260)
2025-08-08 20:19:00,691 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 042bab49aaa7487cade5af2a6a1571e7 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'sushi-example' AND table_schema = 'sqlmesh__sushimoderate') AND table_name IN ('sushimoderate__waiter_names__1494776325', 'sushimoderate__items__4183556318', 'sushimoderate__customer_segments__1796916946', 'sushimoderate__customer_revenue_by_day__2161423016', 'sushimoderate__customers__1460721243', 'sushimoderate__orders__2553744583', 'sushimoderate__order_items__3229655664', 'sushimoderate__customer_lifetime_value__3451320949', 'sushimoderate__top_waiters__4200137544', 'sushimoderate__customer_revenue_lifetime__2371348360', 'sushimoderate__waiter_revenue_by_day__2502736145') (base.py:2260)
2025-08-08 20:19:00,700 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema "sushi-example".sqlmesh__raw (evaluator.py:361)
2025-08-08 20:19:00,700 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 042bab49aaa7487cade5af2a6a1571e7 */ SELECT CURRENT_CATALOG() (base.py:2260)
2025-08-08 20:19:00,701 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 042bab49aaa7487cade5af2a6a1571e7 */ SELECT CURRENT_CATALOG() (base.py:2260)
2025-08-08 20:19:00,702 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 042bab49aaa7487cade5af2a6a1571e7 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'sushi-example' AND table_schema = 'sqlmesh__raw') AND table_name IN ('raw__items__1587933360', 'raw__demographics__3399964752', 'raw__marketing__2281409975', 'raw__orders__1960537533', 'raw__order_items__654969149') (base.py:2260)
2025-08-08 20:19:00,705 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-08-08 20:19:00,706 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-08-08 20:19:00,706 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:167)
2025-08-08 20:19:00,736 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:125)
2025-08-08 20:19:00,738 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"sushi-example"."sushimoderate"."customer_segments": 1674842376> (snapshot.py:143)
2025-08-08 20:19:00,742 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-08-08 20:19:00,745 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema '"sushi-example".sushimoderate' (evaluator.py:1176)
2025-08-08 20:19:00,745 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 042bab49aaa7487cade5af2a6a1571e7 */ CREATE SCHEMA IF NOT EXISTS "sushi-example"."sushimoderate" (base.py:2260)
2025-08-08 20:19:00,746 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view '"sushi-example".sushimoderate.customer_segments' to point at table '"sushi-example".sqlmesh__sushimoderate.sushimoderate__customer_segments__1796916946' (evaluator.py:1493)
2025-08-08 20:19:00,746 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 042bab49aaa7487cade5af2a6a1571e7 */ CREATE OR REPLACE VIEW "sushi-example"."sushimoderate"."customer_segments" AS SELECT * FROM "sushi-example"."sqlmesh__sushimoderate"."sushimoderate__customer_segments__1796916946" (base.py:2260)
2025-08-08 20:19:00,751 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-08-08 20:19:00,751 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:139)
2025-08-08 20:19:00,776 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
