# tests/test_customer_lifetime_value.yaml
test_customer_lifetime_value:
  model: sushimoderate.customer_lifetime_value
  inputs:
    sushimoderate.customer_revenue_lifetime:
      # cumulative series for a single customer across 3 months
      - {customer_id: 1, ds: 2024-01-01, revenue: 100}
      - {customer_id: 1, ds: 2024-02-01, revenue: 250}
      - {customer_id: 1, ds: 2024-03-01, revenue: 450}
  outputs:
    query:
      - customer_id: 1
        first_order_date: 2024-01-01
        active_months: 3
        historical_revenue: 450.0
        lifetime_value: 900.0

